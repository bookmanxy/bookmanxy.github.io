---
layout: post
title:  "网络（三）--TCP"
categories: java基础
tags:  网络 TCP/IP
author: watermelon
---
* content
{:toc}

![网络--TCP](https://images.gitee.com/uploads/images/2019/0127/135438_f52a58c8_1210188.jpeg)
## 前言
网络模块中整理收录UDP相关内容






### 1：为什么
三次握手，四次挥手机制


### 2：是什么
TCP（Transmission Control Protocol 传输控制协议）是一种面向连接的、可靠的、基于字节流的传输层通信协议，由 IETF 的RFC 793定义。TCP 是面向连接的、可靠的流协议。
流就是指不间断的数据结构，你可以把它想象成排水管中的水流。  
TCP 为了保证报文传输的可靠，就给每个包一个序号，同时序号也保证了传送到接收端实体的包的按序接收。  
然后接收端实体对已成功收到的字节发回一个相应的确认(ACK)；如果发送端实体在合理的往返时延(RTT)内未收到确认，那么对应的数据（假设丢失了）将会被重传。  

TCP是因特网中的传输层协议，使用三次握手协议建立连接。
当主动方发出SYN连接请求后，等待对方回答 SYN + ACK ，并最终对对方的 SYN 执行 ACK 确认。
这种建立连接的方法可以防止产生错误的连接，TCP 使用的流量控制协议是可变大小的滑动窗口协议。

##### 连接建立
![三次握手](https://images.gitee.com/uploads/images/2019/0127/175019_dce09daa_1210188.jpeg)

* 1、客户端发送 SYN（SEQ=x）报文给服务器端，进入 SYN_SEND 状态。
* 2、服务器端收到 SYN 报文，回应一个 SYN （SEQ=y）ACK(ACK=x+1）报文，进入 SYN_RECV 状态。
* 3、客户端收到服务器端的 SYN 报文，回应一个 ACK(ACK=y+1）报文，进入 Established 状态。

三次握手完成，TCP客户端和服务器端成功地建立连接，可以开始传输数据了。

##### 连接终止
![四次挥手](https://images.gitee.com/uploads/images/2019/0127/175159_76b82bdd_1210188.jpeg)

* 1、某个应用进程首先调用 close，称该端执行“主动关闭”（active close）。该端的 TCP 于是发送一个 FIN 分节，表示数据发送完毕。
* 2、接收到这个 FIN 的对端执行 “被动关闭”（passive close），这个 FIN 由 TCP 确认。 
```text
注意：FIN 的接收也作为一个文件结束符（end-of-file）传递给接收端应用进程，放在已排队等候该应用进程接收的任何其他数据之后，因为，FIN 的接收意味着接收端应用进程在相应连接上再无额外数据可接收。
```

* 3、一段时间后，接收到这个文件结束符的应用进程将调用 close 关闭它的套接字。这导致它的 TCP 也发送一个 FIN。
* 4、接收这个最终FIN的原发送端 TCP（即执行主动关闭的那一端）确认这个 FIN。 既然每个方向都需要一个 FIN 和一个 ACK，因此通常需要4个分节。

无论是客户还是服务器，任何一端都可以执行主动关闭。通常情况是，客户执行主动关闭，但是某些协议，例如，HTTP/1.0却由服务器执行主动关闭。

### 3：怎么用



  
引用：
 [《带你了解TCP/IP，UDP，Socket之间关系》](https://blog.csdn.net/chaoshenzhaoxichao/article/details/79785318)  


